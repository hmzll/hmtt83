(self["webpackChunkhmtt83"]=self["webpackChunkhmtt83"]||[]).push([[350],{4350:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return L}});var a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("van-nav-bar",{scopedSlots:n._u([{key:"left",fn:function(){return[e("div",{staticClass:"logo"})]},proxy:!0},{key:"right",fn:function(){return[e("van-button",{attrs:{round:"",icon:"search",type:"primary"},on:{click:function(t){return n.$router.push("/search")}}},[n._v("搜索")])]},proxy:!0}])}),e("van-tabs",{model:{value:n.tabIndex,callback:function(t){n.tabIndex=t},expression:"tabIndex"}},[n._l(n.ownChannels,(function(n){return e("van-tab",{key:n.id,attrs:{title:n.name}},[e("article-list",{attrs:{channel_id:n.id}})],1)})),e("div",{staticClass:"icon-box"},[e("van-icon",{attrs:{name:"wap-nav"},on:{click:function(t){n.showChannel=!0}}})],1)],2),e("van-action-sheet",{attrs:{title:"频道管理"},model:{value:n.showChannel,callback:function(t){n.showChannel=t},expression:"showChannel"}},[e("channel",{attrs:{ownList:n.ownChannels,allList:n.allChannels},on:{close:function(t){n.showChannel=!1}},model:{value:n.tabIndex,callback:function(t){n.tabIndex=t},expression:"tabIndex"}})],1)],1)},r=[],i=e(7906),s=e(6198),o=(e(1249),e(8862),e(7214)),l=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{ref:"artList",staticClass:"article-list",on:{scroll:n.onScroll}},[e("van-pull-refresh",{on:{refresh:n.onRefresh},model:{value:n.pullLoading,callback:function(t){n.pullLoading=t},expression:"pullLoading"}},[e("van-list",{attrs:{finished:n.finished,"finished-text":"没有更多了"},on:{load:n.onLoad},model:{value:n.loading,callback:function(t){n.loading=t},expression:"loading"}},n._l(n.list,(function(t){return e("van-cell",{key:t.art_id,on:{click:function(e){return n.$router.push({name:"article",query:{id:t.art_id}})}}},[[e("div",[n._v(n._s(t.title))]),e("van-grid",{attrs:{border:!1,"column-num":t.cover.type}},n._l(t.cover.images,(function(n,t){return e("van-grid-item",{key:t},[e("van-image",{attrs:{src:n}})],1)})),1),e("div",{staticClass:"info"},[e("span",[n._v(n._s(t.aut_name))]),e("span",[n._v(n._s(t.comm_count)+"评论")]),e("span",[n._v(n._s(n._f("relvTime")(t.pubdate)))]),e("van-icon",{attrs:{name:"cross"}})],1)]],2)})),1)],1)],1)},c=[],u=e(8932),d={props:{channel_id:{required:!0}},data:function(){return{list:[],pullLoading:!1,loading:!1,finished:!1,timestamp:Date.now(),scrollTop:0}},methods:{onScroll:function(){this.scrollTop=this.$refs.artList.scrollTop},onLoad:function(){var n=this;return(0,s.Z)((0,i.Z)().mark((function t(){var e,a;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,o.P8)({channel_id:n.channel_id,timestamp:n.timestamp});case 2:a=t.sent,(e=n.list).push.apply(e,(0,u.Z)(a.data.data.results)),n.timestamp=a.data.data.pre_timestamp,n.loading=!1,null==a.data.data.pre_timestamp&&(n.finished=!0);case 7:case"end":return t.stop()}}),t)})))()},onRefresh:function(){var n=this;return(0,s.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,o.P8)({channel_id:n.channel_id,timestamp:Date.now()});case 2:e=t.sent,n.list=e.data.data.results,n.timestamp=e.data.data.pre_timestamp,n.pullLoading=!1;case 6:case"end":return t.stop()}}),t)})))()}},activated:function(){this.$refs.artList.scrollTop=this.scrollTop}},f=d,h=e(1001),p=(0,h.Z)(f,l,c,!1,null,"d3b86b82",null),v=p.exports,m=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("div",{staticClass:"my-box"},[e("div",{staticClass:"title"},[e("span",[n._v("我的频道")]),e("van-button",{staticStyle:{float:"right"},attrs:{plain:"",type:"danger",size:"small"},on:{click:function(t){n.isShow=!n.isShow}}},[n._v(n._s(n.isShow?"取消":"编辑"))])],1),e("van-grid",n._l(n.ownList,(function(t,a){return e("van-grid-item",{key:t.id},[e("span",{staticClass:"sp",class:{active:a==n.value},on:{click:function(t){return n.onSpanClick(a)}}},[n._v(n._s(t.name))]),e("van-icon",{directives:[{name:"show",rawName:"v-show",value:n.isShow&&0!=a,expression:"isShow && index != 0"}],attrs:{name:"cross"},on:{click:function(t){return n.del(a)}}})],1)})),1)],1),e("div",{staticClass:"my-box"},[n._m(0),e("van-grid",n._l(n.optionalList,(function(t){return e("van-grid-item",{key:t.id,attrs:{text:t.name},on:{click:function(e){return n.ownList.push(t)}}})})),1)],1)])},w=[function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"title"},[e("span",[n._v("可选频道")])])}],_=(e(9653),e(561),e(7327),e(1539),e(4553),{props:{ownList:{type:Array,required:!0},allList:{type:Array,required:!0},value:{type:Number,required:!0}},data:function(){return{isShow:!1}},methods:{del:function(n){this.ownList.splice(n,1),n<this.value&&this.$emit("input",this.value-1)},onSpanClick:function(n){this.$emit("input",n),this.$emit("close")}},computed:{optionalList:function(){var n=this;return this.allList.filter((function(t){return-1==n.ownList.findIndex((function(n){return n.id==t.id}))}))}}}),b=_,x=(0,h.Z)(b,m,w,!1,null,"6419a3b3",null),y=x.exports,k={name:"home",components:{articleList:v,channel:y},data:function(){return{ownChannels:[],allChannels:[],showChannel:!1,tabIndex:0,LOCAL_KEY:"channels"}},created:function(){var n=this;return(0,s.Z)((0,i.Z)().mark((function t(){var e,a,r;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=JSON.parse(window.localStorage.getItem(n.LOCAL_KEY)),!n.$store.state.tokenObj.token&&e){t.next=8;break}return t.next=4,(0,o.pZ)();case 4:a=t.sent,n.ownChannels=a.data.data.channels,t.next=9;break;case 8:n.ownChannels=e;case 9:return t.next=11,(0,o.xi)();case 11:r=t.sent,n.allChannels=r.data.data.channels;case 13:case"end":return t.stop()}}),t)})))()},watch:{ownChannels:function(){var n=this;return(0,s.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.showChannel){t.next=9;break}if(!n.$store.state.tokenObj.token){t.next=8;break}return e=n.ownChannels.map((function(n,t){return{id:n.id,seq:t+1}})),t.next=5,(0,o.As)({channels:e});case 5:t.sent,t.next=9;break;case 8:window.localStorage.setItem(n.LOCAL_KEY,JSON.stringify(n.ownChannels));case 9:case"end":return t.stop()}}),t)})))()}},destroyed:function(){console.log("home销毁了")}},g=k,C=(0,h.Z)(g,a,r,!1,null,"46de578a",null),L=C.exports},4553:function(n,t,e){"use strict";var a=e(2109),r=e(2092).findIndex,i=e(1223),s="findIndex",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),a({target:"Array",proto:!0,forced:o},{findIndex:function(n){return r(this,n,arguments.length>1?arguments[1]:void 0)}}),i(s)},1038:function(n,t,e){var a=e(2109),r=e(8457),i=e(7072),s=!i((function(n){Array.from(n)}));a({target:"Array",stat:!0,forced:s},{from:r})},3748:function(n,t,e){"use strict";function a(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=n[e];return a}e.d(t,{Z:function(){return a}})},8932:function(n,t,e){"use strict";e.d(t,{Z:function(){return l}});var a=e(3748);function r(n){if(Array.isArray(n))return(0,a.Z)(n)}e(2526),e(1817),e(1539),e(2165),e(8783),e(3948),e(1038);function i(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}var s=e(8936);e(1703);function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(n){return r(n)||i(n)||(0,s.Z)(n)||o()}},8936:function(n,t,e){"use strict";e.d(t,{Z:function(){return r}});e(7042),e(1539),e(8309),e(1038),e(8783),e(4916),e(7601);var a=e(3748);function r(n,t){if(n){if("string"===typeof n)return(0,a.Z)(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?(0,a.Z)(n,t):void 0}}}}]);